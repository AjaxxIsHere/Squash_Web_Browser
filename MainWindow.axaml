<Window xmlns="https://github.com/avaloniaui"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                xmlns:controls="clr-namespace:Squash_Web_Browser.Controls"
                xmlns:vm="clr-namespace:Squash_Web_Browser.ViewModels"
                x:DataType="vm:MainWindowViewModel"
                mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
                x:Class="Squash_Web_Browser.MainWindow"
                Title="Squash Browser"
                MinWidth="800" MinHeight="500">
    <DockPanel>
        <!-- Menu Bar Placeholder -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="File">
                <MenuItem Header="New Tab" />
                <MenuItem Header="New Window" />
                <MenuItem Header="Open File..." />
                <Separator />
                <MenuItem Header="Exit" />
            </MenuItem>
            <MenuItem Header="View">
                <MenuItem Header="Toggle Sidebar" />
                <MenuItem Header="Zoom In" />
                <MenuItem Header="Zoom Out" />
                <MenuItem Header="Reset Zoom" />
            </MenuItem>
            <MenuItem Header="History">
                <MenuItem Header="Show All History" />
                <MenuItem Header="Clear Recent History" />
            </MenuItem>
            <MenuItem Header="Bookmarks">
                <MenuItem Header="Bookmark This Page" />
                <MenuItem Header="Show All Bookmarks" />
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Downloads" />
                <MenuItem Header="Settings" />
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="About" />
            </MenuItem>
        </Menu>

        <!-- Address bar -->
        <controls:AddressBar Name="AddressBar" DockPanel.Dock="Top" />

        <!-- Main content split: sidebar + web content -->
        <Grid Name="MainGrid" ColumnDefinitions="500,*" RowDefinitions="*">
            <!-- Sidebar with tabbed panels (bookmarks/history/downloads/settings) -->
            <TabControl Margin="4" Grid.Column="0" Name="SidebarTabControl">
                <TabItem Header="Bookmarks">
                    <controls:BookmarksPanel />
                </TabItem>
                <TabItem Header="History">
                    <controls:HistoryPanel />
                </TabItem>
                <TabItem Header="Downloads">
                    <controls:DownloadsPanel />
                </TabItem>
                <TabItem Header="Settings">
                    <controls:SettingsPanel />
                </TabItem>
            </TabControl>

            <!-- Raw HTML + Links side-by-side layout -->
            <Grid Grid.Column="1" Margin="4" RowDefinitions="Auto,Auto,*">
                <!-- Status / controls row -->
                <StackPanel Orientation="Vertical" Spacing="8" Margin="0,0,0,4">
                    <TextBlock Text="Status:" FontWeight="Bold"/>
                    <TextBlock Text="{Binding Status}"/>
                    <TextBlock Text="Loading..." Foreground="#FFA500" IsVisible="{Binding IsBusy}" Margin="16,0,0,0"/>
                </StackPanel>

                <!-- Parsed meta info -->
                <StackPanel Orientation="Horizontal" Spacing="12" Grid.Row="1" Margin="0,0,0,6">
                    <TextBlock Text="Title:" FontWeight="Bold"/>
                    <TextBlock Text="{Binding PageTitle}" MaxWidth="500" TextTrimming="CharacterEllipsis"/>
                    <TextBlock Text="Links:" FontWeight="Bold" Margin="24,0,0,0"/>
                    <TextBlock Text="{Binding LinkCount}"/>
                </StackPanel>

                <!-- Side-by-side content area -->
                <Grid Grid.Row="2" ColumnDefinitions="3*,2*" ColumnSpacing="8">
                    <!-- Raw HTML -->
                    <Border Background="#101010" CornerRadius="4" BorderBrush="#333" BorderThickness="1" IsVisible="{Binding ShowHtml}" Grid.Column="0">
                        <ScrollViewer HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible">
                            <TextBox Text="{Binding HtmlSource}" IsReadOnly="True" AcceptsReturn="True" AcceptsTab="True"
                                     Background="#101010" Foreground="#E0E0E0" FontFamily="Consolas, Courier New, monospace"
                                     FontSize="13" TextWrapping="NoWrap" BorderThickness="0" MinHeight="200"/>
                        </ScrollViewer>
                    </Border>

                    <!-- Links list -->
                    <Border Grid.Column="1" BorderBrush="#333" BorderThickness="1" CornerRadius="4" Padding="4">
                        <Grid RowDefinitions="Auto,*">
                            <TextBlock Text="Links Found" FontWeight="Bold" Margin="2,0,0,4"/>
                            <ScrollViewer Grid.Row="1">
                                <ItemsControl ItemsSource="{Binding Links}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate x:DataType="vm:ParsedLink">
                                            <StackPanel Orientation="Horizontal" Spacing="8" Margin="2,2,2,2">
                                                <TextBlock Text="•"/>
                                                <TextBlock Text="{Binding Text}" FontWeight="SemiBold"/>
                                                <TextBlock Text="→" Margin="8,0,0,0"/>
                                                <TextBlock Text="{Binding Href}" Foreground="#5AA9FF" TextDecorations="Underline"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </DockPanel>
</Window>
